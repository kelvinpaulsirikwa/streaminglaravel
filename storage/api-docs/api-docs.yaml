openapi: 3.0.0
info:
  title: Rashid Backend API Documentation
  version: 1.0.0
  description: Complete API Documentation for Rashid Backend Application
  contact:
    name: Rashid Backend Team
servers:
  - url: http://127.0.0.1:8000
    description: Rashid Backend API Server

paths:
  # User Authentication
  /api/user/google-login:
    post:
      tags:
        - User Authentication
      summary: Google OAuth Login
      description: This endpoint handles Google OAuth login by checking if the email exists, updating or creating user data, and returning user data with Sanctum token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - username
              properties:
                email:
                  type: string
                  format: email
                  example: user@example.com
                username:
                  type: string
                  example: johndoe
                image:
                  type: string
                  nullable: true
                  example: https://example.com/avatar.jpg
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Login successful
                  data:
                    type: object
                    properties:
                      user:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          email:
                            type: string
                            format: email
                            example: user@example.com
                          username:
                            type: string
                            example: johndoe
                          image:
                            type: string
                            nullable: true
                            example: https://example.com/avatar.jpg
                          created_at:
                            type: string
                            format: date-time
                            example: 2024-01-15T10:30:00Z
                          updated_at:
                            type: string
                            format: date-time
                            example: 2024-01-20T15:45:00Z
                      token:
                        type: string
                        example: 1|abc123token456
                      token_type:
                        type: string
                        example: Bearer
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: The given data was invalid.
                  errors:
                    type: object
                    example:
                      email:
                        - The email field is required.

  # User Subscriptions
  /api/user/subscriptions:
    get:
      tags:
        - User Subscriptions
      summary: Get user subscriptions
      description: Get authenticated user's subscriptions with pagination. Returns superstars with their details
      security:
        - sanctum: []
      parameters:
        - name: per_page
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            default: 15
      responses:
        '200':
          description: Subscriptions retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        user_id:
                          type: integer
                          example: 5
                        display_name:
                          type: string
                          example: John Doe
                        bio:
                          type: string
                          example: Professional streamer
                        price_per_minute:
                          type: number
                          format: float
                          example: 0.50
                        is_available:
                          type: boolean
                          example: true
                        rating:
                          type: number
                          format: float
                          example: 4.5
                        total_followers:
                          type: integer
                          example: 1500
                        status:
                          type: string
                          example: active
                        subscribed_at:
                          type: string
                          format: date-time
                          example: 2024-01-15T10:30:00Z
                  pagination:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      last_page:
                        type: integer
                        example: 5
                      per_page:
                        type: integer
                        example: 15
                      total:
                        type: integer
                        example: 75
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized
    post:
      tags:
        - User Subscriptions
      summary: Subscribe to superstar
      description: Subscribe to a superstar and increases total_followers count
      security:
        - sanctum: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - superstar_id
              properties:
                superstar_id:
                  type: integer
                  example: 1
      responses:
        '200':
          description: Subscription successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Subscribed successfully
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized
        '404':
          description: Superstar not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Superstar not found
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation failed
                  errors:
                    type: object
                    example:
                      superstar_id:
                        - The superstar id field is required.

  # Superstar Authentication
  /api/superstar/login:
    post:
      tags:
        - Superstar Authentication
      summary: Superstar Login
      description: Login endpoint for superstars using email or username
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - login
                - password
              properties:
                login:
                  type: string
                  description: Email or username
                  example: superstar@example.com
                password:
                  type: string
                  format: password
                  example: password123
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Login successful
                  superstar:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      user_id:
                        type: integer
                        example: 5
                      display_name:
                        type: string
                        example: John Doe
                      bio:
                        type: string
                        example: Professional superstar
                      price_per_hour:
                        type: number
                        format: float
                        example: 50.00
                      is_available:
                        type: boolean
                        example: true
                      rating:
                        type: number
                        format: float
                        example: 4.5
                      total_followers:
                        type: integer
                        example: 1500
                      status:
                        type: string
                        example: active
                      username:
                        type: string
                        example: johndoe
                      email:
                        type: string
                        format: email
                        example: superstar@example.com
                      role:
                        type: string
                        example: superstar
                      created_at:
                        type: string
                        format: date-time
                        example: 2024-01-15T10:30:00Z
                  token:
                    type: string
                    example: 1|abc123token456
                  token_type:
                    type: string
                    example: Bearer
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid credentials
        '403':
          description: Admin access forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Please use admin app for admin access
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation failed
                  errors:
                    type: object
                    example:
                      login:
                        - The login field is required.

  /api/superstar/logout:
    post:
      tags:
        - Superstar Authentication
      summary: Logout superstar
      description: Logout authenticated superstar and revoke token
      security:
        - sanctum: []
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Logged out successfully
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized

  /api/superstar/me:
    get:
      tags:
        - Superstar Authentication
      summary: Get authenticated superstar
      description: Get authenticated superstar's profile information
      security:
        - sanctum: []
      responses:
        '200':
          description: Profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  superstar:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      user_id:
                        type: integer
                        example: 5
                      display_name:
                        type: string
                        example: John Doe
                      bio:
                        type: string
                        example: Professional superstar
                      price_per_hour:
                        type: number
                        format: float
                        example: 50.00
                      is_available:
                        type: boolean
                        example: true
                      rating:
                        type: number
                        format: float
                        example: 4.5
                      total_followers:
                        type: integer
                        example: 1500
                      status:
                        type: string
                        example: active
                      username:
                        type: string
                        example: johndoe
                      email:
                        type: string
                        format: email
                        example: superstar@example.com
                      role:
                        type: string
                        example: superstar
                      created_at:
                        type: string
                        format: date-time
                        example: 2024-01-15T10:30:00Z
                      updated_at:
                        type: string
                        format: date-time
                        example: 2024-01-20T15:45:00Z
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized

  /api/superstar/profile:
    put:
      tags:
        - Superstar Profile
      summary: Update superstar profile
      description: Update authenticated superstar's profile information
      security:
        - sanctum: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                display_name:
                  type: string
                  example: John Doe
                bio:
                  type: string
                  example: Professional superstar
                price_per_hour:
                  type: number
                  format: float
                  example: 50.00
                is_available:
                  type: boolean
                  example: true
                username:
                  type: string
                  example: johndoe
                email:
                  type: string
                  format: email
                  example: john@example.com
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Profile updated successfully
                  superstar:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      user_id:
                        type: integer
                        example: 5
                      display_name:
                        type: string
                        example: John Doe
                      bio:
                        type: string
                        example: Professional superstar
                      price_per_hour:
                        type: number
                        format: float
                        example: 50.00
                      is_available:
                        type: boolean
                        example: true
                      rating:
                        type: number
                        format: float
                        example: 4.5
                      total_followers:
                        type: integer
                        example: 1500
                      status:
                        type: string
                        example: active
                      username:
                        type: string
                        example: johndoe
                      email:
                        type: string
                        format: email
                        example: superstar@example.com
                      role:
                        type: string
                        example: superstar
                      created_at:
                        type: string
                        format: date-time
                        example: 2024-01-15T10:30:00Z
                      updated_at:
                        type: string
                        format: date-time
                        example: 2024-01-20T15:45:00Z
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation failed
                  errors:
                    type: object
                    example:
                      username:
                        - The username has already been taken.

  /api/superstar/change-password:
    post:
      tags:
        - Superstar Authentication
      summary: Change superstar password
      description: Change authenticated superstar's password
      security:
        - sanctum: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - current_password
                - new_password
              properties:
                current_password:
                  type: string
                  format: password
                  example: oldpassword123
                new_password:
                  type: string
                  format: password
                  minLength: 8
                  example: newpassword123
                new_password_confirmation:
                  type: string
                  format: password
                  example: newpassword123
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Password changed successfully
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Validation failed
                  errors:
                    type: object
                    example:
                      current_password:
                        - The current password field is required.

  # Superstar Payments
  /api/superstar/payments/history:
    get:
      tags:
        - Superstar Payments
      summary: Get superstar payment history
      description: Fetch superstar's own payment history with pagination
      security:
        - sanctum: []
      parameters:
        - name: page
          in: query
          description: Page number
          required: false
          schema:
            type: integer
            default: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 15
      responses:
        '200':
          description: Payment history retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  payments:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        user_id:
                          type: integer
                          example: 5
                        superstar_id:
                          type: integer
                          example: 2
                        amount:
                          type: number
                          format: float
                          example: 25.50
                        payment_method:
                          type: string
                          example: credit_card
                        status:
                          type: string
                          example: completed
                        created_at:
                          type: string
                          format: date-time
                          example: 2024-01-15T10:30:00Z
                        updated_at:
                          type: string
                          format: date-time
                          example: 2024-01-15T10:35:00Z
                  pagination:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      last_page:
                        type: integer
                        example: 3
                      per_page:
                        type: integer
                        example: 15
                      total:
                        type: integer
                        example: 42
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Unauthorized

components:
  securitySchemes:
    sanctum:
      type: http
      scheme: bearer
      bearerFormat: JWT
